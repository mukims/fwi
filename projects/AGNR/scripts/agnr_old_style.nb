(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35205,        798]
NotebookOptionsPosition[     32965,        757]
NotebookOutlinePosition[     33408,        774]
CellTagsIndexPosition[     33365,        771]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "[", 
   RowBox[{
   "\[Omega]_", ",", "\[Delta]_", ",", "t_", ",", "\[Epsilon]_", ",", "m_"}], 
   "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Omega]", "+", 
       RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}], "-", "\[Epsilon]"}], ")"}], 
     RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"2", ",", "m", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "m", ",", "1"}], "]"}]}], "}"}]}], "]"}]}], 
      "]"}], "\[Rule]", "t"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.776415447198865*^9, 3.776415495965315*^9}, {
   3.7764160317266607`*^9, 3.7764160838197308`*^9}, 3.776416166847925*^9, {
   3.7764162799500628`*^9, 3.776416285068152*^9}, {3.7768461432456503`*^9, 
   3.776846150341238*^9}, {3.776846181987039*^9, 3.776846188723722*^9}, {
   3.777790886258019*^9, 3.77779088626001*^9}, {3.7882622878809767`*^9, 
   3.788262311784668*^9}, {3.792760987151804*^9, 3.792760999784857*^9}, {
   3.79542776040763*^9, 3.795427774791172*^9}, 3.821384297704117*^9, 
   3.825515501035747*^9, 3.826719981827523*^9, 3.8448520710634527`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d33301b4-430e-4abd-a91d-a57e6511a663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T1", "[", 
   RowBox[{"t_", ",", "m_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", "=", 
      RowBox[{"0", "*", 
       RowBox[{"IdentityMatrix", "[", "m", "]"}]}]}], "}"}], ",", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"K", ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "x"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2", ",", "m", ",", "2"}], "}"}]}], "]"}], 
       "\[Rule]", "t"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8267200167722063`*^9, 3.826720032610161*^9}, {
  3.844852132999181*^9, 3.84485213410306*^9}, {3.844852185935281*^9, 
  3.8448522130957413`*^9}, {3.844852356919537*^9, 3.844852369831334*^9}, {
  3.8448524089916058`*^9, 3.8448524189835463`*^9}, {3.844852471023382*^9, 
  3.844852506023532*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"8c56b515-9489-4805-b733-de05a492a87a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T2", "[", 
   RowBox[{"t_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"t", "*", 
    RowBox[{"IdentityMatrix", "[", "m", "]"}]}], "-", 
   RowBox[{"T1", "[", 
    RowBox[{"t", ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.844852481459519*^9, 3.8448525138337193`*^9}, {
   3.8448526389514503`*^9, 3.8448526717992992`*^9}, 3.8448531842503223`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"d06b84f7-cfbb-48ca-82d9-1933575927a3"],

Cell[BoxData[
 RowBox[{"Clear", "[", "LEFT", "]"}]], "Input",
 CellChangeTimes->{{3.844859037611862*^9, 3.844859040506777*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"9ce867fd-cfee-4e9f-afaf-7715c21388d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LEFT", "[", 
   RowBox[{"\[Omega]_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"LEFT", "[", 
    RowBox[{"\[Omega]", ",", "m"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"J", "=", 
        RowBox[{"Inverse", "[", 
         RowBox[{"\[Beta]", "[", 
          RowBox[{"\[Omega]", ",", "0.001", ",", "1", ",", "0", ",", "m"}], 
          "]"}], "]"}]}], ",", 
       RowBox[{"A", ":=", 
        RowBox[{"Inverse", "[", 
         RowBox[{"\[Beta]", "[", 
          RowBox[{"\[Omega]", ",", "0.001", ",", "1", ",", "0", ",", "m"}], 
          "]"}], "]"}]}], ",", 
       RowBox[{"Ta", ":=", 
        RowBox[{"T1", "[", 
         RowBox[{"1", ",", "m"}], "]"}]}], ",", 
       RowBox[{"Tb", "=", " ", 
        RowBox[{"T2", "[", 
         RowBox[{"1", ",", "m"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"J", "=", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", 
            RowBox[{"A", ".", "Tb", ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "m", "]"}], "-", 
               RowBox[{"A", ".", "Ta", ".", "J", ".", "Ta"}]}], "]"}], ".", 
             "A", ".", "Tb"}]}], "]"}], ".", "A"}]}], ",", "5000"}], "]"}], 
      ";", 
      RowBox[{"J", "=", "J"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.776420432638335*^9, 3.776420448744707*^9}, {
   3.776420571978689*^9, 3.776420581332512*^9}, {3.7764206818746853`*^9, 
   3.776420685175613*^9}, {3.776420717028468*^9, 3.7764207209483633`*^9}, {
   3.776420785737459*^9, 3.776420788375815*^9}, {3.7764208321171427`*^9, 
   3.7764208353316174`*^9}, {3.776420870132489*^9, 3.7764208722555447`*^9}, {
   3.776420910220142*^9, 3.776420914712381*^9}, {3.7764209782452602`*^9, 
   3.776420993372328*^9}, {3.776423190189245*^9, 3.776423190235486*^9}, {
   3.776433003368771*^9, 3.7764330097519627`*^9}, 3.776433937359056*^9, {
   3.7768461635432796`*^9, 3.776846169109446*^9}, 3.776846581069193*^9, 
   3.777020876677054*^9, {3.77773249680203*^9, 3.777732518194194*^9}, {
   3.777790886265594*^9, 3.777790906205792*^9}, {3.77779169122859*^9, 
   3.777791691230357*^9}, 3.788521183245915*^9, {3.791202944475298*^9, 
   3.791202945370565*^9}, 3.792761009031456*^9, {3.7954277918875933`*^9, 
   3.7954278265035686`*^9}, {3.795428379818688*^9, 3.795428382794585*^9}, 
   3.795463780387328*^9, {3.797324995748807*^9, 3.797325002754589*^9}, {
   3.797759850926877*^9, 3.797759898812212*^9}, 3.797920962627481*^9, {
   3.798054480179246*^9, 3.798054487455595*^9}, {3.798381910380846*^9, 
   3.798381920820736*^9}, {3.8060579048943644`*^9, 3.806057914862372*^9}, {
   3.8060580061535473`*^9, 3.8060580136341867`*^9}, {3.807949946534182*^9, 
   3.807949959886611*^9}, 3.807950008289834*^9, {3.81495281662177*^9, 
   3.814952819889817*^9}, {3.819899444065819*^9, 3.819899456199643*^9}, {
   3.819901169790243*^9, 3.819901192338175*^9}, {3.825322546079644*^9, 
   3.8253225497892313`*^9}, {3.826719743964919*^9, 3.826719776271159*^9}, {
   3.82672004171797*^9, 3.826720043059585*^9}, {3.827848292802206*^9, 
   3.827848351041819*^9}, 3.842085882970313*^9, {3.844852112359336*^9, 
   3.844852120256927*^9}, {3.844852709223876*^9, 3.8448527474718037`*^9}, {
   3.844852894319659*^9, 3.8448529878958282`*^9}, {3.844853066848041*^9, 
   3.844853069497827*^9}, 3.8448533510677137`*^9, {3.8448533833079033`*^9, 
   3.844853385296219*^9}, {3.844859030397629*^9, 3.844859035818424*^9}, {
   3.844860275361377*^9, 3.844860275930834*^9}, {3.8448610087040157`*^9, 
   3.8448610117036257`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"6a045a46-dc13-4445-96c5-26d8a824ed48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f1", "[", 
   RowBox[{"y_", ",", "start_", ",", "stop_"}], "]"}], ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "start", ",", "stop"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.82690086397169*^9, 3.8269008706436157`*^9}, {
  3.826901005778653*^9, 3.826901005873879*^9}, {3.8277480407045937`*^9, 
  3.827748044112603*^9}, {3.827843910049469*^9, 3.827843911299659*^9}, {
  3.827848622147862*^9, 3.827848643729912*^9}, {3.827848695171042*^9, 
  3.827848696225314*^9}, {3.827849105970644*^9, 3.827849129057735*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"02131649-125a-4a2b-b63c-b01b05c87571"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"xstart_", ",", "xstop_", ",", "ystart_", ",", "ystop_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"J", "=", 
      RowBox[{"f1", "[", 
       RowBox[{"ystart", ",", "xstart", ",", "xstop"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"J", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"f1", "[", 
           RowBox[{"y", ",", "xstart", ",", "xstop"}], "]"}], ",", "J"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"ystart", "+", "1"}], ",", "ystop"}], "}"}]}], "]"}], ";", 
     RowBox[{"J", "=", "J"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8269008787235193`*^9, 3.826901010627098*^9}, {
  3.827748049827857*^9, 3.8277480705120068`*^9}, {3.827843913815568*^9, 
  3.827843917508233*^9}, {3.8278439815271072`*^9, 3.827843982435656*^9}, {
  3.827848705987694*^9, 3.8278487144505*^9}, {3.827849169763378*^9, 
  3.82784927774788*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"d61ef77c-244f-410c-b7fd-7ea212ccd2dc"],

Cell[BoxData[
 RowBox[{"Clear", "[", "dist", "]"}]], "Input",
 CellChangeTimes->{{3.844854978344613*^9, 3.8448549812901077`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"71acd6a0-7a7a-4268-beba-054603306f19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dist", "[", 
   RowBox[{"total_", ",", "concentration_", ",", "area_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dist", "[", 
    RowBox[{"total", ",", "concentration", ",", "area"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"s", "[", 
             RowBox[{"1", ",", "100", ",", "1", ",", 
              RowBox[{"Round", "[", 
               RowBox[{"area", "/", "2"}], "]"}]}], "]"}], "]"}], ",", 
           "concentration"}], "]"}], ",", 
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"s", "[", 
             RowBox[{"1", ",", "100", ",", 
              RowBox[{"area", "-", 
               RowBox[{"Round", "[", 
                RowBox[{"area", "/", "2"}], "]"}]}], ",", "area"}], "]"}], 
            "]"}], ",", 
           RowBox[{"total", "-", "concentration"}]}], "]"}]}], "]"}], ",", 
       "First"}], "]"}], ",", "10000"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.827748078882523*^9, 3.827748102415781*^9}, {
   3.82774841294664*^9, 3.8277484213782053`*^9}, {3.827748570946783*^9, 
   3.827748572549312*^9}, {3.8277487417852583`*^9, 3.827748743044861*^9}, 
   3.827821682328824*^9, {3.8278218356455927`*^9, 3.827821837368334*^9}, {
   3.827825919290386*^9, 3.82782591938503*^9}, 3.827826042489747*^9, {
   3.827836301541058*^9, 3.82783630160367*^9}, 3.827836420612225*^9, {
   3.827836556163619*^9, 3.8278365570569773`*^9}, 3.827842979717846*^9, {
   3.827843394247497*^9, 3.827843436035674*^9}, 3.8278435066550283`*^9, {
   3.827843684759025*^9, 3.827843711767428*^9}, {3.827843798183145*^9, 
   3.827843798323503*^9}, {3.827843932907205*^9, 3.827843942883486*^9}, {
   3.8278439929673157`*^9, 3.827844015698944*^9}, {3.827844632596285*^9, 
   3.8278446327054453`*^9}, 3.827844746391465*^9, {3.8278448003430777`*^9, 
   3.827844805091619*^9}, {3.827845567432394*^9, 3.827845568628687*^9}, {
   3.82784940113957*^9, 3.827849403207838*^9}, {3.8278494488507633`*^9, 
   3.8278494650098867`*^9}, 3.827849584825046*^9, {3.82791860508595*^9, 
   3.8279186054372063`*^9}, {3.827918639358827*^9, 3.827918644013237*^9}, 
   3.8279186914862413`*^9, {3.8279195788974237`*^9, 3.82791959244741*^9}, {
   3.832856363109709*^9, 3.8328564282598953`*^9}, {3.832856813262542*^9, 
   3.832856861916807*^9}, {3.833346334059701*^9, 3.833346359959008*^9}, {
   3.833346394321928*^9, 3.833346415701213*^9}, {3.833346608165609*^9, 
   3.833346620529992*^9}, {3.842426565888864*^9, 3.842426569509572*^9}, 
   3.842428236850101*^9, {3.842428486452009*^9, 3.8424285336927433`*^9}, {
   3.842428787525549*^9, 3.8424288049781437`*^9}, {3.8425954357109537`*^9, 
   3.842595441811651*^9}, {3.842597068512252*^9, 3.842597082324691*^9}, {
   3.842597278862165*^9, 3.8425972803486547`*^9}, {3.842700427516849*^9, 
   3.8427004591239367`*^9}, {3.8427006319652233`*^9, 3.842700661202243*^9}, {
   3.843043636248715*^9, 3.843043636312295*^9}, {3.843211074936496*^9, 
   3.8432110751107683`*^9}, {3.844506450216774*^9, 3.844506457015592*^9}, {
   3.844507801997828*^9, 3.8445078229474087`*^9}, {3.844508107652529*^9, 
   3.844508136924103*^9}, {3.84450820466052*^9, 3.84450820897222*^9}, {
   3.844508840261654*^9, 3.8445088403528557`*^9}, {3.844508919020513*^9, 
   3.8445089307881393`*^9}, 3.844751846592738*^9, {3.8447527262009172`*^9, 
   3.84475273011099*^9}, {3.844766907319664*^9, 3.844766925216157*^9}, {
   3.84476697049642*^9, 3.8447669792918653`*^9}, {3.844778721902049*^9, 
   3.844778746257517*^9}, {3.844854537280355*^9, 3.844854543384202*^9}, {
   3.8448545746802387`*^9, 3.844854578304517*^9}, {3.844854662624208*^9, 
   3.844854666648569*^9}, {3.844854788345598*^9, 3.844854798776334*^9}, {
   3.844854855850544*^9, 3.84485488587425*^9}, {3.844854959208722*^9, 
   3.8448549644084873`*^9}},
 NumberMarks->False,
 CellLabel->"In[8]:=",ExpressionUUID->"4fe02b93-31fe-4bbe-9648-97dd9fe1a682"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{
   "\[Omega]_", ",", "\[Delta]_", ",", "t_", ",", "\[Epsilon]_", ",", 
    "\[Epsilon]1_", ",", "area_", ",", "total_", ",", "concentration_", ",", 
    "number_", ",", "unitcell_"}], "]"}], ":=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"J", "=", 
       RowBox[{"\[Beta]", "[", 
        RowBox[{
        "\[Omega]", ",", "\[Delta]", ",", "t", ",", "\[Epsilon]", ",", 
         "area"}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"J", "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", "=", "unitcell"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"dist", "[", 
                 RowBox[{"total", ",", "concentration", ",", "area"}], "]"}], 
                "[", 
                RowBox[{"[", "number", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"loc1", ",", "1"}], "]"}], "]"}], "==", "m"}], ",", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"J", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"dist", "[", 
                    RowBox[{"total", ",", "concentration", ",", "area"}], 
                    "]"}], "[", 
                    RowBox[{"[", "number", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"loc1", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dist", "[", 
                    RowBox[{"total", ",", "concentration", ",", "area"}], 
                    "]"}], "[", 
                    RowBox[{"[", "number", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"loc1", ",", "2"}], "]"}], "]"}]}], "}"}], "}"}], 
                "\[Rule]", 
                RowBox[{"\[Omega]", "+", 
                 RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}], "-", 
                 "\[Epsilon]1"}]}]}], "]"}], ",", "J"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"loc1", ",", "total"}], "}"}]}], "]"}], ";", "J"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.84485523148072*^9, 3.8448552783208103`*^9}, {
  3.844855322216722*^9, 3.844855324184924*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"26dca67a-42f3-410f-b4d4-becc5d211c9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CA", "[", 
   RowBox[{
   "\[Omega]_", ",", "\[Delta]_", ",", "t_", ",", "\[Epsilon]_", ",", 
    "\[Epsilon]1_", ",", "total_", ",", "concentration_", ",", "number_", ",",
     "size_", ",", "area_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"recurs", "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"J1", "=", 
          RowBox[{"LEFT", "[", 
           RowBox[{"\[Omega]", ",", "area"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"J1", "=", 
            RowBox[{
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "area", "]"}], "-", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{
                 "\[Omega]", ",", "\[Delta]", ",", "t", ",", "\[Epsilon]", 
                  ",", "\[Epsilon]1", ",", "area", ",", "total", ",", 
                  "concentration", ",", "number", ",", 
                  RowBox[{"unitcell", "+", "1"}]}], "]"}], ".", 
                RowBox[{"T2", "[", 
                 RowBox[{"t", ",", "area"}], "]"}], ".", 
                RowBox[{"Inverse", "[", 
                 RowBox[{
                  RowBox[{"IdentityMatrix", "[", "area", "]"}], "-", 
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{
                    "\[Omega]", ",", "\[Delta]", ",", "t", ",", "\[Epsilon]", 
                    ",", "\[Epsilon]1", ",", "area", ",", "total", ",", 
                    "concentration", ",", "number", ",", "unitcell"}], "]"}], 
                   ".", 
                   RowBox[{"T1", "[", 
                    RowBox[{"1", ",", "area"}], "]"}], ".", "J1", ".", 
                   RowBox[{"T1", "[", 
                    RowBox[{"1", ",", "area"}], "]"}]}]}], "]"}], ".", 
                RowBox[{"f", "[", 
                 RowBox[{
                 "\[Omega]", ",", "\[Delta]", ",", "t", ",", "\[Epsilon]", 
                  ",", "\[Epsilon]1", ",", "area", ",", "total", ",", 
                  "concentration", ",", "number", ",", "unitcell"}], "]"}], 
                ".", 
                RowBox[{"T2", "[", 
                 RowBox[{"t", ",", "area"}], "]"}]}]}], "]"}], ".", 
             RowBox[{"f", "[", 
              RowBox[{
              "\[Omega]", ",", "\[Delta]", ",", "t", ",", "\[Epsilon]", ",", 
               "\[Epsilon]1", ",", "area", ",", "total", ",", "concentration",
                ",", "number", ",", 
               RowBox[{"unitcell", "+", "1"}]}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"unitcell", ",", "1", ",", "100", ",", "2"}], "}"}]}], 
          "]"}], ";", 
         RowBox[{"J1", "=", "J1"}]}]}], "]"}]}], ";", 
     RowBox[{"ir", "=", 
      RowBox[{
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "area", "]"}], "-", 
         RowBox[{
          RowBox[{"LEFT", "[", 
           RowBox[{"\[Omega]", ",", "area"}], "]"}], ".", 
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}], ".", "recurs", ".", 
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}]}]}], "]"}], ".", 
       RowBox[{"LEFT", "[", 
        RowBox[{"\[Omega]", ",", "area"}], "]"}]}]}], ";", 
     RowBox[{"il", "=", 
      RowBox[{
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "area", "]"}], "-", 
         RowBox[{"recurs", ".", 
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}], ".", 
          RowBox[{"LEFT", "[", 
           RowBox[{"\[Omega]", ",", "area"}], "]"}], ".", 
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}]}]}], "]"}], ".", "recurs"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"gdd1", "=", " ", 
      RowBox[{"il", "-", 
       RowBox[{"ConjugateTranspose", "[", "il", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"grr1", "=", " ", 
      RowBox[{"ir", "-", 
       RowBox[{"ConjugateTranspose", "[", "ir", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Gnonlocalrl", "=", 
      RowBox[{"ir", ".", 
       RowBox[{"T1", "[", 
        RowBox[{"1", ",", "area"}], "]"}], ".", "recurs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GNON1", "=", " ", 
      RowBox[{"Gnonlocalrl", "-", 
       RowBox[{"ConjugateTranspose", "[", "Gnonlocalrl", "]"}]}]}], ";", 
     RowBox[{"TRA", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"gdd1", ".", 
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}], ".", "grr1", ".", 
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}], ".", "GNON1", ".", 
          RowBox[{"T1", "[", 
           RowBox[{"1", ",", "area"}], "]"}], ".", "GNON1"}]}], "]"}], 
       "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TRA", ">", "10"}], ",", "10", ",", "TRA"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.825243436385845*^9, 3.825243505329316*^9}, {
   3.825243605420253*^9, 3.8252437646436577`*^9}, {3.825243796146318*^9, 
   3.8252438119383917`*^9}, {3.8252438936979227`*^9, 3.825243904963284*^9}, {
   3.825243977635501*^9, 3.8252439799430723`*^9}, {3.825244021153934*^9, 
   3.8252440478752527`*^9}, {3.825244309414631*^9, 3.825244322899475*^9}, 
   3.825246575308576*^9, {3.825247498502585*^9, 3.8252475172691936`*^9}, {
   3.8253229273810883`*^9, 3.82532298589242*^9}, {3.825323126387417*^9, 
   3.825323126593195*^9}, 3.8254035601871653`*^9, 3.825503853303492*^9, 
   3.825503912317873*^9, {3.825509118131276*^9, 3.82550911849527*^9}, {
   3.82551061293062*^9, 3.825510661335329*^9}, {3.825510724321393*^9, 
   3.8255107426342773`*^9}, {3.825511117635137*^9, 3.825511156223905*^9}, {
   3.8255132585718412`*^9, 3.825513265384267*^9}, {3.8255134581298323`*^9, 
   3.825513494946254*^9}, {3.825513677696828*^9, 3.825513707400301*^9}, {
   3.825513772449604*^9, 3.8255137775056562`*^9}, {3.8255138176112213`*^9, 
   3.8255138268231287`*^9}, {3.825513970644299*^9, 3.8255140230573606`*^9}, {
   3.825514062053644*^9, 3.825514062177658*^9}, {3.825514126917925*^9, 
   3.825514129632984*^9}, {3.8255142011260233`*^9, 3.825514210481423*^9}, {
   3.8255144065165787`*^9, 3.8255144159442368`*^9}, {3.8255196549015512`*^9, 
   3.825519656017465*^9}, {3.825524277734736*^9, 3.8255243034924088`*^9}, {
   3.8255246785675297`*^9, 3.825524678749681*^9}, {3.825524800373776*^9, 
   3.825524827261344*^9}, {3.825524874783114*^9, 3.825524884901721*^9}, {
   3.825524932614574*^9, 3.825524950381259*^9}, {3.825525283366497*^9, 
   3.8255253266607733`*^9}, {3.825603098213112*^9, 3.825603102292576*^9}, {
   3.825603142709198*^9, 3.82560314288459*^9}, {3.8257737690410633`*^9, 
   3.82577376918864*^9}, {3.8260251687028646`*^9, 3.8260251936328773`*^9}, 
   3.826095827081039*^9, {3.826701059050188*^9, 3.8267010604108458`*^9}, {
   3.826701489162264*^9, 3.826701490889155*^9}, {3.826701676986125*^9, 
   3.8267016791148148`*^9}, {3.826705586989386*^9, 3.826705589626536*^9}, {
   3.8267056270698023`*^9, 3.826705627482568*^9}, {3.827845688645528*^9, 
   3.8278457232498817`*^9}, {3.827845773970235*^9, 3.8278458125946836`*^9}, 
   3.8279214022246923`*^9, {3.8286202002469587`*^9, 3.8286202061342773`*^9}, {
   3.842428974691777*^9, 3.842428982750318*^9}, {3.84259731715273*^9, 
   3.842597323482609*^9}, {3.844767238607057*^9, 3.844767317825425*^9}, {
   3.84476750892712*^9, 3.844767553293679*^9}, {3.844773984568619*^9, 
   3.8447739847970448`*^9}, {3.844774198961965*^9, 3.844774200887005*^9}, 
   3.844774592577559*^9, {3.844774789385878*^9, 3.844774789532645*^9}, {
   3.8447748455802517`*^9, 3.8447748772364893`*^9}, 3.844775272817368*^9, {
   3.844777931282896*^9, 3.844777931365439*^9}, {3.84477867631511*^9, 
   3.844778690052293*^9}, {3.84477879059052*^9, 3.844778827469401*^9}, {
   3.844855058993973*^9, 3.844855063250259*^9}, {3.844855195234178*^9, 
   3.844855220201458*^9}, {3.84485543015282*^9, 3.844855469217499*^9}, 
   3.844855512265374*^9, 3.844855578593483*^9, {3.8448557073149014`*^9, 
   3.844855714345447*^9}, {3.844856707593732*^9, 3.8448568267811337`*^9}, {
   3.844856880210115*^9, 3.844856880682786*^9}, {3.844857000586935*^9, 
   3.844857100193994*^9}, {3.844857700652424*^9, 3.844857725763097*^9}, {
   3.844857764658409*^9, 3.844857795451084*^9}, {3.84485796805838*^9, 
   3.8448579687964563`*^9}, {3.844858022308817*^9, 3.844858029794713*^9}, {
   3.844858069757053*^9, 3.844858080003417*^9}, {3.844858112652821*^9, 
   3.8448581178269043`*^9}, {3.844858202229739*^9, 3.8448582409014273`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f48afd6e-fec6-4e9c-a34e-7b120034b7bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"CA", "[", 
     RowBox[{
     "1", ",", "0.001", ",", "1", ",", "0", ",", "1", ",", "100", ",", "50", 
      ",", "NUM", ",", "1", ",", "15"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"NUM", ",", "1000"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.844866415851589*^9, 3.844866427886962*^9}, {
  3.844866463594026*^9, 3.844866489226296*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"8e1bfc34-92ea-46cc-a36a-b42588110346"],

Cell[BoxData["1.0738002012989118`"], "Output",
 CellChangeTimes->{{3.8448664383022003`*^9, 3.844866464065943*^9}, 
   3.844866541465399*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"49f39dea-2c8e-49b2-af75-9e038d421710"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"CA", "[", 
         RowBox[{
         "1", ",", "0.001", ",", "1", ",", "0", ",", "1", ",", "x", ",", 
          RowBox[{"x", "/", "2"}], ",", "num", ",", "1", ",", "15"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"num", ",", "2000"}], "}"}]}], "]"}], "//", "Mean"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "10", ",", "100", ",", "10"}], "}"}]}], "]"}], ",", 
   "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.844864503560713*^9, 3.844864537197983*^9}, {
  3.84486457480552*^9, 3.844864585558256*^9}, {3.844864832776174*^9, 
  3.844864861453218*^9}, {3.844866550050456*^9, 3.844866562314093*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"5649d4da-e858-421b-b9fb-89e12c8d98d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.561602808137281`", ",", "3.203774854277006`", ",", "2.2767250250533513`",
    ",", "1.681647204905668`", ",", "1.344629781587329`", ",", 
   "1.192994052124454`", ",", "1.105789270478963`", ",", 
   "1.0972131398720062`", ",", "1.0385853949283452`", ",", 
   "1.0914127766643689`"}], "}"}]], "Output",
 CellChangeTimes->{3.844867234914256*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"91039db7-f944-433e-a978-c63d7588f276"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
   "4.561602808137281`", ",", "3.203774854277006`", ",", 
    "2.2767250250533513`", ",", "1.681647204905668`", ",", 
    "1.344629781587329`", ",", "1.192994052124454`", ",", 
    "1.105789270478963`", ",", "1.0972131398720062`", ",", 
    "1.0385853949283452`", ",", "1.0914127766643689`"}], "}"}], 
  "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[15]:=",ExpressionUUID->"d71cca20-a277-433e-ad3d-c84e471356d2"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{1., 4.561602808137281}, {2., 3.203774854277006}, {3., 
     2.2767250250533513`}, {4., 1.681647204905668}, {5., 1.344629781587329}, {
     6., 1.192994052124454}, {7., 1.105789270478963}, {8., 
     1.0972131398720062`}, {9., 1.0385853949283452`}, {10., 
     1.0914127766643689`}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 10.}, {0, 4.561602808137281}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.844868358062893*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"641cf05c-8c7c-4176-a940-dd03ad2b6ac8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"CA", "[", 
         RowBox[{
         "1", ",", "0.001", ",", "1", ",", "0", ",", "1", ",", "50", ",", 
          "25", ",", "1", ",", "1", ",", "m"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"3", ",", "20", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
    "m"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.844858162337407*^9, 3.844858173121439*^9}, 
   3.844858401034439*^9, {3.844858454090123*^9, 3.844858455482316*^9}, 
   3.844858509538163*^9, {3.844858612483815*^9, 3.8448586548905773`*^9}, {
   3.84486021270656*^9, 3.844860217330255*^9}, {3.844861405090497*^9, 
   3.844861428038954*^9}, 3.844862484330159*^9, 3.8448630986348658`*^9, {
   3.8448637631707687`*^9, 3.844863813961176*^9}, 
   3.844864416144244*^9},ExpressionUUID->"7b24e67f-20c3-421a-a60c-\
6f32a7278ddc"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
     LineBox[{{3., 0.999999000002}, {4., 1.9999976000079935`}, {5., 
      1.9999955555959794`}, {6., 2.999992000131794}, {7., 
      2.999987000369986}, {8., 3.9999795564887157`}, {9., 
      3.9999696021210016`}, {10., 4.999956004497848}, {11., 
      4.99993856449217}, {12., 5.999916016828925}, {13., 5.999888030289249}, {
      14., 6.999853207916041}, {15., 6.999811087424037}, {16., 
      7.999760141546529}, {17., 7.999699778565344}, {18., 
      8.999628342890947}, {19., 8.99954511578564}, {20., 
      9.999448316192119}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 20.}, {0, 9.999448316192119}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.844861322374939*^9, 3.844861414980166*^9, 
  3.844861663422175*^9, 3.844863061287614*^9, 3.844863718087945*^9, 
  3.8448637923900223`*^9, 3.844863893422535*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"5f11aa90-191e-4944-8445-0c44e515e207"]
}, Open  ]]
},
WindowSize->{1386, 752},
WindowMargins->{{Automatic, 231}, {Automatic, 151}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e5eeb826-a11e-4fea-b75d-cc27df412dc2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1793, 43, 30, "Input",ExpressionUUID->"d33301b4-430e-4abd-a91d-a57e6511a663"],
Cell[2354, 65, 999, 25, 30, "Input",ExpressionUUID->"8c56b515-9489-4805-b733-de05a492a87a"],
Cell[3356, 92, 474, 11, 30, "Input",ExpressionUUID->"d06b84f7-cfbb-48ca-82d9-1933575927a3"],
Cell[3833, 105, 205, 3, 30, "Input",ExpressionUUID->"9ce867fd-cfee-4e9f-afaf-7715c21388d4"],
Cell[4041, 110, 3805, 74, 53, "Input",ExpressionUUID->"6a045a46-dc13-4445-96c5-26d8a824ed48"],
Cell[7849, 186, 738, 15, 30, "Input",ExpressionUUID->"02131649-125a-4a2b-b63c-b01b05c87571"],
Cell[8590, 203, 1135, 28, 30, "Input",ExpressionUUID->"d61ef77c-244f-410c-b7fd-7ea212ccd2dc"],
Cell[9728, 233, 208, 3, 30, "Input",ExpressionUUID->"71acd6a0-7a7a-4268-beba-054603306f19"],
Cell[9939, 238, 4092, 72, 53, "Input",ExpressionUUID->"4fe02b93-31fe-4bbe-9648-97dd9fe1a682"],
Cell[14034, 312, 2655, 67, 163, "Input",ExpressionUUID->"26dca67a-42f3-410f-b4d4-becc5d211c9f"],
Cell[16692, 381, 9002, 179, 383, "Input",ExpressionUUID->"f48afd6e-fec6-4e9c-a34e-7b120034b7bd"],
Cell[CellGroupData[{
Cell[25719, 564, 531, 12, 30, "Input",ExpressionUUID->"8e1bfc34-92ea-46cc-a36a-b42588110346"],
Cell[26253, 578, 219, 3, 34, "Output",ExpressionUUID->"49f39dea-2c8e-49b2-af75-9e038d421710"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26509, 586, 878, 21, 30, "Input",ExpressionUUID->"5649d4da-e858-421b-b9fb-89e12c8d98d2"],
Cell[27390, 609, 467, 9, 34, "Output",ExpressionUUID->"91039db7-f944-433e-a978-c63d7588f276"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27894, 623, 489, 11, 30, "Input",ExpressionUUID->"d71cca20-a277-433e-ad3d-c84e471356d2"],
Cell[28386, 636, 1530, 40, 274, "Output",ExpressionUUID->"641cf05c-8c7c-4176-a940-dd03ad2b6ac8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29953, 681, 1041, 24, 30, "Input",ExpressionUUID->"7b24e67f-20c3-421a-a60c-6f32a7278ddc"],
Cell[30997, 707, 1952, 47, 247, "Output",ExpressionUUID->"5f11aa90-191e-4944-8445-0c44e515e207"]
}, Open  ]]
}
]
*)

